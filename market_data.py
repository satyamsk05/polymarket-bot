import requests\nimport pandas as pd\nimport sqlite3\n\ndef fetch_btc_data(exchange_url):\n    response = requests.get(exchange_url)\n    return response.json()\n\ndef process_ohlcv_data(data):\n    df = pd.DataFrame(data)\n    df['timestamp'] = pd.to_datetime(df['timestamp'], unit='s')\n    df.set_index('timestamp', inplace=True)\n    return df\n\ndef store_data_in_db(df, db_name='market_data.db'):\n    conn = sqlite3.connect(db_name)\n    df.to_sql('btc_market_data', conn, if_exists='replace')\n    conn.close()\n\ndef main():\n    exchange_url = 'https://api.example.com/btc/ohlcv'  # Replace with actual exchange API URL\n    btc_data = fetch_btc_data(exchange_url)\n    processed_data = process_ohlcv_data(btc_data)\n    store_data_in_db(processed_data)\n\nif __name__ == '__main__':\n    main()